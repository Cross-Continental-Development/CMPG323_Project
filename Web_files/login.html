<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Page - Share2Teach</title>
  <link rel="stylesheet" href="CSS/login.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
      <nav>
          <ul>
              <li><a href="Home.html">Home</a></li>
              <li><a href="Search.html">Search</a></li>
              <li><a href="SelfDirectedLearning.html">Self-Directed Learning</a></li>
              <li><a href="subjectview.html">Subjects</a></li>
              <li><a href="useful_oer.html">Useful OER</a></li>
              <li><a href="Contributors.html">Contributors</a></li>
              <li><a href="Contribute.html">Contribute</a></li>
              <li><a href="FAQ.html">FAQ</a></li>
              <li><a href="about_us.html">About Us</a></li>
              <li><a href="Analytics.html">Analytics</a></li>
              <li><a href="Moderate.html">Moderate</a></li>
              <li><a href="account.html">Account</a></li>
          </ul>
      </nav>
  </header>

  <!-- Main Section -->
  <main>
    <section class="login-container">
      <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
      <form id="loginForm">
        <div class="input-container">
          <label for="username"><i class="fas fa-user"></i> Username:</label>
          <input type="text" id="username" name="username" required>
        </div>
        <div class="input-container">
          <label for="password"><i class="fas fa-lock"></i> Password:</label>
          <input type="password" id="password" name="password" required>
        </div>
        <button onclick="callUserAPI()" type="submit" class="login-button">Login <i class="fas fa-arrow-right"></i></button>
      </form>
      <div id="message"></div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; 2024 Share2Teach. All rights reserved.</p>
    <nav>
        <ul>
            <li><a href="about_us.html" class="footer-button">About Us</a></li>
            <li><a href="Home.html" class="footer-button">Back to Home</a></li>
            <li><a href="account.html" class="footer-button">Accounts</a></li>
        </ul>
    </nav>
</footer>

  <script>
    async function callUserAPI() {
            try {

                let query = "https://ccdshare2teachapi.azure-api.net/USERS";
                const response = await fetch(query, {
                    method: 'GET',
                    headers: {
                        'Host': 'ccdshare2teachapi.azure-api.net',
                        // Add any required authorization headers if needed
                        //'Authorization': 'Bearer YOUR_TOKEN_HERE'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const data = await response.json();
                console.log(data);                
                

                for(var i = 0; i< data.length;i++){
                    if(data[i].username == document.getElementById('username').value){
                      document.getElementById('password').value = JSON.stringify(data[i].password, null, 2);
                        if(submittedpassword == userPass){
                            document.getElementById("message").innerHTML = 'Login Successfull';
                        }
                        else{
                            document.getElementById("message").innerHTML = 'Password Incorrect';
                        }     
                    }
                    else{
                        document.getElementById("message").innerHTML = 'Username does not exist';
                    }
                }


            } 
            catch (error) {
                console.error('Error:', error);
                document.getElementById("message").innerText = 'Error: ' + error.message;
            }
        }

</script>
</body>
</html>
